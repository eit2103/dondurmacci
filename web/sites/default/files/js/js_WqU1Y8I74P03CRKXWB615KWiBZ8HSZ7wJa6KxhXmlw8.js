/* @license GNU-GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function($){var initialLocaleCode='en';var dialogIndex=0;var dialogs=[];var slotDate;function eventRender(info){let viewIndex=parseInt(this.el.getAttribute("data-calendar-view-index"));let viewSettings=drupalSettings.fullCalendarView[viewIndex];let eventTitleEle=info.el.getElementsByClassName('fc-title');if(eventTitleEle.length>0)eventTitleEle[0].innerHTML=info.event.title;let eventListTitleEle=info.el.getElementsByClassName('fc-list-item-title');if(eventListTitleEle.length>0)if(info.event.url)eventListTitleEle[0].innerHTML='<a href="'+info.event.url+'">'+info.event.title+'</a>';else eventListTitleEle[0].innerHTML=info.event.title;if(viewSettings.dialogModal)if($(info.el).is('a')){$(info.el).addClass('use-ajax');if(!viewSettings.dialogCanvas)$(info.el).attr('data-dialog-type','modal');else{$(info.el).attr('data-dialog-type','dialog');$(info.el).attr('data-dialog-renderer','off_canvas');}$(info.el).attr('data-dialog-options',viewSettings.dialog_modal_options);$(info.el).attr('href',$(info.el).attr('href').replaceAll('&amp;','&'));}else $(info.el).find('a').each(function(){if(!viewSettings.dialogCanvas)$(this).attr('data-dialog-type','modal');else{$(this).attr('data-dialog-type','dialog');$(this).attr('data-dialog-renderer','off_canvas');}$(this).attr('data-dialog-options',viewSettings.dialog_modal_options);$(this).addClass('use-ajax');$(this).attr('href',$(this).attr('href').replaceAll('&amp;','&'));});}function eventResize(info){const end=info.event.end;const start=info.event.start;let strEnd='';let strStart='';let viewIndex=parseInt(this.el.getAttribute("data-calendar-view-index"));let viewSettings=drupalSettings.fullCalendarView[viewIndex];const formatSettings={month:'2-digit',year:'numeric',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit',timeZone:'UTC',locale:'sv-SE'};if(end){if(end.getHours()==0&&end.getMinutes()==0&&end.getSeconds()==0)end.setDate(end.getDate()-1);strEnd=FullCalendar.formatDate(end,formatSettings);}if(start)strStart=FullCalendar.formatDate(start,formatSettings);const title=info.event.title.replace(/(<([^>]+)>)/ig,"");;const msg=Drupal.t('@title end is now @event_end. Do you want to save this change?',{'@title':title,'@event_end':strEnd});if(viewSettings.updateConfirm===1&&!confirm(msg))info.revert();else jQuery.post(drupalSettings.path.baseUrl+"fullcalendar-view-event-update",{eid:info.event.extendedProps.eid,entity_type:viewSettings.entityType,start:strStart,end:strEnd,start_field:viewSettings.startField,end_field:viewSettings.endField,token:viewSettings.token}).done(function(data){if(data!=='1'){alert("Error: "+data);info.revert();}});}function dayClickCallback(info){slotDate=info.dateStr;}function eventClick(info){slotDate=null;info.jsEvent.preventDefault();let thisEvent=info.event;let viewIndex=parseInt(this.el.getAttribute("data-calendar-view-index"));let viewSettings=drupalSettings.fullCalendarView[viewIndex];let des=thisEvent.extendedProps.des;if(viewSettings.dialogWindow){let dataDialogOptionsDetails={};if(des=='')return false;const jsFrame=new JSFrame({parentElement:info.el});let posOffset=dialogIndex*20;let dialogOptions=JSON.parse(viewSettings.dialog_options);dialogOptions.left+=posOffset+info.jsEvent.pageX;dialogOptions.top+=posOffset+info.jsEvent.pageY;dialogOptions.title=dialogOptions.title?dialogOptions.title:thisEvent.title.replace(/(<([^>]+)>)/ig,"");dialogOptions.html=des;dialogs[dialogIndex]=jsFrame.create(dialogOptions);dialogs[dialogIndex].show();dialogIndex++;return false;}if(thisEvent.url){let eventURL=new URL(thisEvent.url,location.origin);if(eventURL.origin==="null")return false;if(viewSettings.openEntityInNewTab){window.open(thisEvent.url);return false;}else{window.location.href=thisEvent.url;return false;}}return false;}function eventDrop(info){const end=info.event.end;const start=info.event.start;let strEnd='';let strStart='';let viewIndex=parseInt(this.el.getAttribute("data-calendar-view-index"));let viewSettings=drupalSettings.fullCalendarView[viewIndex];const formatSettings={month:'2-digit',year:'numeric',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit',timeZone:'UTC',locale:'sv-SE'};if(end){if(end.getHours()==0&&end.getMinutes()==0&&end.getSeconds()==0)end.setDate(end.getDate()-1);strEnd=FullCalendar.formatDate(end,formatSettings);}if(start)strStart=FullCalendar.formatDate(start,formatSettings);const title=info.event.title.replace(/(<([^>]+)>)/ig,"");;const msg=Drupal.t('@title start is now @event_start and end is now @event_end - Do you want to save this change?',{'@title':title,'@event_start':strStart,'@event_end':strEnd});if(viewSettings.updateConfirm===1&&!confirm(msg))info.revert();else jQuery.post(drupalSettings.path.baseUrl+"fullcalendar-view-event-update",{eid:info.event.extendedProps.eid,entity_type:viewSettings.entityType,start:strStart,end:strEnd,start_field:viewSettings.startField,end_field:viewSettings.endField,token:viewSettings.token}).done(function(data){if(data!=='1'){alert("Error: "+data);info.revert();}});}function datesRender(info){Drupal.attachBehaviors(info.el);}function datesDestroy(info){Drupal.detachBehaviors(info.el);}function buildCalendars(){$('.js-drupal-fullcalendar').each(function(){let calendarEl=this;let viewIndex=parseInt(calendarEl.getAttribute("data-calendar-view-index"));let viewSettings=drupalSettings.fullCalendarView[viewIndex];var calendarOptions=JSON.parse(viewSettings.calendar_options);if(calendarOptions.mobileWidth!==undefined&&calendarOptions.defaultMobileView!==undefined&&$(window).width()<=calendarOptions.mobileWidth)calendarOptions.defaultView=calendarOptions.defaultMobileView;calendarOptions.eventRender=eventRender;calendarOptions.eventResize=eventResize;calendarOptions.dateClick=dayClickCallback;calendarOptions.eventClick=eventClick;calendarOptions.eventDrop=eventDrop;calendarOptions.datesRender=datesRender;calendarOptions.datesDestroy=datesDestroy;var localeSelectorEl=document.getElementById('locale-selector-'+viewIndex);const params=(new URL(document.location)).searchParams;const initialDate=params.get('initialDate');if(initialDate)calendarOptions.defaultDate=initialDate;if(calendarEl){if(drupalSettings.calendar)drupalSettings.calendar[viewIndex]=new FullCalendar.Calendar(calendarEl,calendarOptions);else{drupalSettings.calendar=[];drupalSettings.calendar[viewIndex]=new FullCalendar.Calendar(calendarEl,calendarOptions);}let calendarObj=drupalSettings.calendar[viewIndex];calendarObj.render();if(viewSettings.languageSelector){calendarObj.getAvailableLocaleCodes().forEach(function(localeCode){var optionEl=document.createElement('option');optionEl.value=localeCode;optionEl.selected=localeCode==calendarOptions.locale;optionEl.innerText=localeCode;localeSelectorEl.appendChild(optionEl);});localeSelectorEl.addEventListener('change',function(){if(this.value){let viewIndex=parseInt(this.getAttribute("data-calendar-view-index"));drupalSettings.calendar[viewIndex].setOption('locale',this.value);}});}else{if(localeSelectorEl)localeSelectorEl.style.display="none";}calendarEl.addEventListener('dblclick',function(e){let viewIndex=parseInt(this.getAttribute("data-calendar-view-index"));let viewSettings=drupalSettings.fullCalendarView[viewIndex];if(slotDate&&viewSettings.eventBundleType&&viewSettings.dblClickToCreate&&viewSettings.addForm!=="")window.open(drupalSettings.path.baseUrl+viewSettings.addForm+"?start="+slotDate+"&start_field="+viewSettings.startField+"&destination="+window.location.pathname,"_blank");});}});}var checkReadyState=setInterval(function(){if(document.readyState==="complete"&&$('.js-drupal-fullcalendar').length>0){clearInterval(checkReadyState);buildCalendars();}},100);$(document).ajaxComplete(function(event,request,settings){if(drupalSettings.calendar&&settings.url!=='/fullcalendar-view-event-update'&&settings.url.indexOf('_wrapper_format=drupal_modal')<0){drupalSettings.calendar.forEach(function(calendar){calendar.destroy();});buildCalendars();}});})(jQuery,Drupal);;
!function(c,s,n){"use strict";var i,r,u=s.blazy||{},t=(s.Ajax||{}).prototype;t&&(t.success=(r=t.success,function(t,e){var o,a=u.init;return clearTimeout(i),i=setTimeout(function(){t&&t.length&&(c.once.unload=!0,a&&(o=u.options,c.find(n,c.selector(o,!0))&&(c.once.removeSafely("b-root","body",n),s.attachBehaviors(n.body))),c.trigger("blazy:ajaxSuccess",[a,t,e]))},100),r.apply(this,arguments)}))}(dBlazy,Drupal,this.document);
;
(function($,Drupal,debounce){$.fn.drupalGetSummary=function(){const callback=this.data('summaryCallback');if(!this[0]||!callback)return '';const result=callback(this[0]);return result?result.trim():'';};$.fn.drupalSetSummary=function(callback){const self=this;if(typeof callback!=='function'){const val=callback;callback=function(){return val;};}return (this.data('summaryCallback',callback).off('formUpdated.summary').on('formUpdated.summary',()=>{self.trigger('summaryUpdated');}).trigger('summaryUpdated'));};Drupal.behaviors.formSingleSubmit={attach(){function onFormSubmit(e){const $form=$(e.currentTarget);const formValues=$form.serialize();const previousValues=$form.attr('data-drupal-form-submit-last');if(previousValues===formValues)e.preventDefault();else $form.attr('data-drupal-form-submit-last',formValues);}$(once('form-single-submit','body')).on('submit.singleSubmit','form:not([method~="GET"])',onFormSubmit);}};function triggerFormUpdated(element){$(element).trigger('formUpdated');}function fieldsList(form){return [].map.call(form.querySelectorAll('[name][id]'),(el)=>el.id);}Drupal.behaviors.formUpdated={attach(context){const $context=$(context);const contextIsForm=context.tagName==='FORM';const $forms=$(once('form-updated',contextIsForm?$context:$context.find('form')));let formFields;if($forms.length)$.makeArray($forms).forEach((form)=>{const events='change.formUpdated input.formUpdated ';const eventHandler=debounce((event)=>{triggerFormUpdated(event.target);},300);formFields=fieldsList(form).join(',');form.setAttribute('data-drupal-form-fields',formFields);$(form).on(events,eventHandler);});if(contextIsForm){formFields=fieldsList(context).join(',');const currentFields=$(context).attr('data-drupal-form-fields');if(formFields!==currentFields)triggerFormUpdated(context);}},detach(context,settings,trigger){const $context=$(context);const contextIsForm=context.tagName==='FORM';if(trigger==='unload')once.remove('form-updated',contextIsForm?$context:$context.find('form')).forEach((form)=>{form.removeAttribute('data-drupal-form-fields');$(form).off('.formUpdated');});}};Drupal.behaviors.fillUserInfoFromBrowser={attach(context,settings){const userInfo=['name','mail','homepage'];const $forms=$(once('user-info-from-browser','[data-user-info-from-browser]'));if($forms.length)userInfo.forEach((info)=>{const $element=$forms.find(`[name=${info}]`);const browserData=localStorage.getItem(`Drupal.visitor.${info}`);if(!$element.length)return;const emptyValue=$element[0].value==='';const defaultValue=$element.attr('data-drupal-default-value')===$element[0].value;if(browserData&&(emptyValue||defaultValue))$element.each(function(index,item){item.value=browserData;});});$forms.on('submit',()=>{userInfo.forEach((info)=>{const $element=$forms.find(`[name=${info}]`);if($element.length)localStorage.setItem(`Drupal.visitor.${info}`,$element[0].value);});});}};const handleFragmentLinkClickOrHashChange=(e)=>{let url;if(e.type==='click')url=e.currentTarget.location?e.currentTarget.location:e.currentTarget;else url=window.location;const hash=url.hash.substring(1);if(hash){const $target=$(`#${hash}`);$('body').trigger('formFragmentLinkClickOrHashChange',[$target]);setTimeout(()=>$target.trigger('focus'),300);}};const debouncedHandleFragmentLinkClickOrHashChange=debounce(handleFragmentLinkClickOrHashChange,300,true);$(window).on('hashchange.form-fragment',debouncedHandleFragmentLinkClickOrHashChange);$(document).on('click.form-fragment','a[href*="#"]',debouncedHandleFragmentLinkClickOrHashChange);})(jQuery,Drupal,Drupal.debounce);;
(($,Drupal)=>{Drupal.behaviors.commerceCartBlock={attach:(context)=>{const $context=$(context);const $cart=$context.find('.cart--cart-block').addBack('.cart--cart-block');const $cartContents=$cart.find('.cart-block--contents');if($cartContents.length>0)$(once('cart-button-processed','.cart-block--link__expand',context)).on('click',(e)=>{e.preventDefault();const windowWidth=$(window).width();const cartWidth=$cartContents.width()+$cart.offset().left;if(cartWidth>windowWidth)$cartContents.addClass('is-outside-horizontal');$cartContents.toggleClass('cart-block--contents__expanded').slideToggle();});}};})(jQuery,Drupal);;
